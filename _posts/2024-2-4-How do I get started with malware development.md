---
layout: post
title: How do I get started with malware development?
date: 2024-2-4
categories: [Miscellaneous]
tags: [misc]     
---

# Introduction

Malware development is an important skill for a red team operator. While some red teams choose to purchase commercial solutions, nothing is more evasive than custom, in-house built tools. In this post I will talk about how to get started with malware development and some challenges you may face along the way.

### Why is getting into maldev challenging?

While for something like pwn you have amazing free resources like `pwn.college' and endless CTFs to practice your skills, there are no such things for maldev. It's also harder to get help or find collaborators because no one can verify that your intentions are not malicious (unless you're dealing with a mind reader). This is a deadly combination that makes starting out as a malware developer quite difficult.

### What programming language should I use?

There is no "best" language for malware development, as each has its pros and cons. Here are some things to consider:

- Rust is harder to reverse engineer than C, but also more difficult to write in.

- While Python is much easier to write than C, it depends on the Python interpreter being present on the target machine.

- As C has been around for decades, machine-learning based security solutions have had extensive training on it. On the other hand, Go and Rust are much newer.

In conclusion, I think starting with C is the best choice, as you will find out which language best suits your needs as you progress.

# So...where do I start?

### Maldev Academy

First of all, I must mention Maldev Academy, which is currently considered one of the best ways to get started in 2024. The course assumes no prior knowledge and starts with C basics and Windows internals before moving on to more advanced topics. Each module has a number of objectives that test your understanding of the content. The site also includes challenges to practice your skills.

I would also recommend Maldev Academy just for the Discord community, as you can interact with other members and find some friends to work on malware with. Networking is the most important skill in cybersecurity (and life!).

Overall, I would suggest getting a lifetime subscription for $499. If you have the money, you can stop reading this post and go get it; I promise you will know where to continue when you are done. If not, don't worry, because next I'll talk about cheaper/free resources.

### Windows APT Warfare by Sheng-Hao Ma

Windows APT Warfare is an amazing book to start with as a (much) cheaper alternative to Maldev Academy. The book delves into the intricacies of Windows system design, from the PE binary structure to modern attack techniques. There are also practical examples of malware that are available on a public github repo. You should set up the environment discussed in the book and follow along with the author, as nothing beats hands-on practice.

All in all, I appreciate the author's straightforward approach and lack of unnecessary fluff.

### Malware Development for Dummies

Maldev for dummies is a github repository containing the slides and exercises presented at X33fcon 2023. It's also how I personally started writing malware. The course covers Nim, C#, Go and Rust. I have adapted the exercises in C because that is my preferred language.

It's free, it's great, the repo speaks for itself!

# Going forward

At this point, you are familiar with C and have a solid understanding of how Windows works. Hell, maybe you even got into reverse engineering Windows in search of new techniques! Or you may have left the comfort of user mode and started developing rootkits. You may also have made friends along the way, with whom you have exchanged ideas and collaborated on projects.

If you've reached this level, you should have a few solid projects under your belt and know how to move forward. If you still want some resources, here goes!

### vx-underground

VX-Underground is the largest repository of malware known to man. It contains samples, papers and sometimes even the source code of popular malware. You can learn a lot by reversing samples of malware created by the APT and studying the papers. I'm sure you'll be inspired!

### Evading EDR by Matt Hand

Evading EDR is another great book covering EDR architecture and evasion strategies. Matt Hand is a very experienced red teamer. He shares his insights and experiences in this book, providing the reader with practical knowledge on the subject.

# Conclusion

I hope these resources have helped you in one way or another. The last piece of advice I want to give you is to ask yourself this question every step of the way:

- Is there a more efficient way of doing this?

- How could I achieve this?

- How could I make this less obvious?

- What if...

Chances are someone else has had one of your ideas before you, but everyone starts somewhere. You will get tired, frustrated, discouraged, but if you keep at it, you will get there.

Now go! Let the legend come back to life!